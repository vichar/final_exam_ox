<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="summative-assignment">Summative Assignment</h1>
<p><strong>Due 21 Jul by 5:59</strong><br>
<strong>Points 0</strong><br>
<strong>Available 4 Jul at 6:00 - 21 Jul at 5:59</strong></p>
<hr>
<h3 id="course-r-programming-for-data-science-introduction">Course: R Programming for Data Science: Introduction</h3>
<p>Please complete the following questions to test your understanding of the concepts covered in the &quot;R Programming for Data Science: Introduction&quot; course. Please submit your code/answers for each question after the question itself. Feel free to refer to the course material and conduct additional research as needed.</p>
<hr>
<h2 id="overview">Overview:</h2>
<p>You are going to use a dataset that was collected and made freely available by the &quot;National Institute of Diabetes and Digestive and Kidney Diseases&quot; as part of the Pima Indians Diabetes Database. The dataset is available to download as part of this assignment via this link:</p>
<p>https://drive.google.com/file/d/1qDkGULtjrXw-H4OPXgPZH6PnVcPBHzYK/view?usp=sharing</p>
<p>The dataset contains the following variables (i.e. columns):</p>
<ul>
<li>Pregnancies: Number of times pregnant</li>
<li>Glucose: Plasma glucose concentration over 2 hours in an oral glucose tolerance test</li>
<li>BloodPressure: Diastolic blood pressure (mm Hg)</li>
<li>SkinThickness: Triceps skin fold thickness (mm)</li>
<li>Insulin: 2-Hour serum insulin (mu U/ml)</li>
<li>BMI: Body mass index (weight in kg/(height in m)2)</li>
<li>DiabetesPedigreeFunction: Diabetes pedigree function (a function which scores likelihood of diabetes based on family history)</li>
<li>Age: Age (years)</li>
<li>Outcome: 0 if non-diabetic, 1 if diabetic</li>
</ul>
<hr>
<h2 id="answer-the-following-questions-by-writing-and-providing-the-required-r-code-to-perform-the-listed-tasks-please-make-sure-you-follow-best-coding-practices-explained-throughout-the-course-also-feel-free-to-perform-intermediary-steps-if-you-think-they-are-needed">Answer the following questions by writing and providing the required R code to perform the listed tasks (Please make sure you follow best coding practices explained throughout the course. Also, feel free to perform intermediary steps if you think they are needed):</h2>
<p>1- Load the dataset, generate a numeric statistical summary of all its variables.</p>
<p>2- The dataset contains missing values. Sometimes those values are blank and some other times a question mark has been used to indicate them. If any variable has more than 20% of its values missing, drop that variable.</p>
<p>3- For the remaining variables, Replace all missing values in each variable by the minimum value in that variable.</p>
<pre class="hljs"><code><div>
<span class="hljs-keyword">library</span>(readr)

PIMA_PATH &lt;- <span class="hljs-string">"Diabetes-data.csv"</span>

<span class="hljs-comment">#' Load PIMA Diabetes Dataset</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' This function loads the PIMA Diabetes dataset from a specified CSV file path using `readr::read_csv`.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param file_path String path to the CSV file.</span>
<span class="hljs-comment">#' @param col_names Logical indicating if the first row contains column names (default is TRUE).</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame containing the loaded dataset.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' load_dataset("Diabetes-data.csv")</span>
load_dataset &lt;- <span class="hljs-keyword">function</span>(file_path, col_names = <span class="hljs-literal">TRUE</span>) {
  data_frame &lt;- read_csv(file_path, col_names)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Compute Statistical Mode</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' This function computes the mode (most frequent value) of a vector, ignoring NAs by default.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param x A vector (numeric, character, or factor).</span>
<span class="hljs-comment">#' @param na.rm Logical indicating whether to ignore missing values. Default is FALSE.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A single value representing the mode, or NA if no mode is found.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' stat_mode(c(1, 2, 2, 3, 3, 3, 4))</span>
stat_mode &lt;- <span class="hljs-keyword">function</span>(x, na.rm = <span class="hljs-literal">FALSE</span>) {
  x &lt;- na.omit(x)
  <span class="hljs-keyword">if</span> (length(x) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span>(<span class="hljs-literal">NA</span>)
  }
  model_value &lt;- names(sort(table(value = x), decreasing = <span class="hljs-literal">TRUE</span>)[<span class="hljs-number">1</span>])
}

<span class="hljs-comment">#' Clean Missing Numeric Columns</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' This function drops columns with more than 20% missing values (NAs) and replaces remaining NAs</span>
<span class="hljs-comment">#' in numeric columns with the column's minimum non-NA value.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame with possible missing values.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A cleaned data frame with no columns over 20% NA and all remaining NAs filled with column minimums.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' clean_missing_numeric_columns(pima_df)</span>
clean_missing_numeric_columns &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  incomplete_numeric_columns &lt;- c()
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
    <span class="hljs-keyword">if</span> (any(is.na(data_frame[[col]]))) {
      incomplete_numeric_columns &lt;- c(incomplete_numeric_columns, col)
    }
  }
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> incomplete_numeric_columns) {
    total_count &lt;- length(data_frame[[col]])
    na_count &lt;- sum(is.na(data_frame[[col]]))
    <span class="hljs-keyword">if</span> ((na_count / total_count) &gt; <span class="hljs-number">0.20</span>) {
      data_frame[[col]] &lt;- <span class="hljs-literal">NULL</span>
    } <span class="hljs-keyword">else</span> {
      min_value &lt;- min(data_frame[[col]])
      data_frame[[col]][is.na(data_frame[[col]])] &lt;- min_value
    }
  }
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Remove Rows Containing Zero Values in Key Columns</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' This function scans each row and removes rows where any numeric column </span>
<span class="hljs-comment">#' (except "Outcome" and "Pregnancies") contains a zero.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A numeric data frame to clean.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame with rows containing zero values (in numeric columns, excluding "Outcome" and "Pregnancies") removed.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' clean_row_with_zero(pima_df)</span>
clean_row_with_zero &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  <span class="hljs-keyword">for</span> (row <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nrow(data_frame)) {
    <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
      <span class="hljs-keyword">if</span> (!(col %<span class="hljs-keyword">in</span>% c(<span class="hljs-string">"Outcome"</span>, <span class="hljs-string">"Pregnancies"</span>)) &amp;&amp;
          is.numeric(data_frame[[col]])) {
        <span class="hljs-keyword">if</span> (!is.na(data_frame[row, col]) &amp;&amp; data_frame[row, col] == <span class="hljs-number">0</span>) {
          value &lt;- data_frame[row, col]
          <span class="hljs-keyword">if</span> (!is.na(value) &amp;&amp; value == <span class="hljs-number">0</span>) {
            data_frame[row] &lt;- <span class="hljs-literal">NA</span>  <span class="hljs-comment"># Set the entire row to NA if a zero is found</span>
          }
        }
      }
    }
  }
  data_frame &lt;- na.omit(data_frame)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Run Full Data Cleaning Pipeline</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' This function loads the PIMA dataset, cleans it by removing columns with too many missing values,</span>
<span class="hljs-comment">#' replaces missing values, and drops rows with zero values in key columns. Then it prints a sample.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return None (prints cleaned data to console).</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' runner()</span>
runner &lt;- <span class="hljs-keyword">function</span>() {
  pima &lt;- load_dataset(PIMA_PATH)
  pima &lt;- clean_missing_numeric_columns(pima)
  cat(<span class="hljs-string">"PIMA Sample Data after cleaning:"</span>, <span class="hljs-string">"\n"</span>)
  print.data.frame(clean_row_with_zero(pima))
}

runner()
</div></code></pre>
<p>Now the dataset should be full without any missing values.</p>
<table>
<thead>
<tr>
<th>Pregnancies</th>
<th>Glucose</th>
<th>BloodPressure</th>
<th>SkinThickness</th>
<th>BMI</th>
<th>DiabetesPedigreeFunction</th>
<th>Age</th>
<th>Outcome</th>
</tr>
</thead>
<tbody>
<tr>
<td>6</td>
<td>148</td>
<td>72</td>
<td>35</td>
<td>33.6</td>
<td>0.627</td>
<td>50</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>85</td>
<td>66</td>
<td>29</td>
<td>26.6</td>
<td>0.351</td>
<td>31</td>
<td>0</td>
</tr>
<tr>
<td>8</td>
<td>183</td>
<td>64</td>
<td>0</td>
<td>23.3</td>
<td>0.672</td>
<td>32</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>89</td>
<td>66</td>
<td>23</td>
<td>28.1</td>
<td>0.167</td>
<td>21</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>137</td>
<td>40</td>
<td>35</td>
<td>43.1</td>
<td>2.288</td>
<td>33</td>
<td>1</td>
</tr>
<tr>
<td>5</td>
<td>116</td>
<td>74</td>
<td>0</td>
<td>25.6</td>
<td>0.201</td>
<td>30</td>
<td>0</td>
</tr>
<tr>
<td>3</td>
<td>78</td>
<td>50</td>
<td>32</td>
<td>31.0</td>
<td>0.248</td>
<td>26</td>
<td>1</td>
</tr>
<tr>
<td>10</td>
<td>115</td>
<td>0</td>
<td>0</td>
<td>35.3</td>
<td>0.134</td>
<td>29</td>
<td>0</td>
</tr>
<tr>
<td>2</td>
<td>197</td>
<td>70</td>
<td>45</td>
<td>30.5</td>
<td>0.158</td>
<td>53</td>
<td>1</td>
</tr>
<tr>
<td>8</td>
<td>125</td>
<td>96</td>
<td>0</td>
<td>NaN</td>
<td>0.232</td>
<td>54</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>4- Some variables will contain 0 values but those values don’t make sense. In this dataset, 0 values only make sense in the Pregnancies and Outcome columns. Drop any row that contains one or more 0’s in any column(s) other than Pregnancies and Outcome.</p>
<p>5- Group the data based on the Outcome column and generate the mean and median values for all other columns.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">library</span>(dplyr)
<span class="hljs-keyword">library</span>(tidyr)
<span class="hljs-keyword">library</span>(readr)
<span class="hljs-keyword">library</span>(styler)

PIMA_PATH &lt;- <span class="hljs-string">"Diabetes-data.csv"</span>
<span class="hljs-comment">#' Load the PIMA Diabetes Dataset</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Loads a CSV file containing the PIMA diabetes dataset using `readr::read_csv`.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param file_path Path to the CSV file.</span>
<span class="hljs-comment">#' @param col_names Logical. Whether the first row contains column names. Default is TRUE.</span>
<span class="hljs-comment">#' @param display_type Logical. Whether to display column type messages. Default is FALSE.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame containing the loaded dataset.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
load_dataset &lt;- <span class="hljs-keyword">function</span>(file_path,
                         col_names = <span class="hljs-literal">TRUE</span>,
                         display_type = <span class="hljs-literal">FALSE</span>) {
  data_frame &lt;- read_csv(file_path, col_names = col_names, show_col_types = display_type)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Calculate the Statistical Mode</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Computes the mode (most frequent value) of a numeric or character vector.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param x A vector (numeric, character, or factor).</span>
<span class="hljs-comment">#' @param na.rm Logical. Whether to ignore missing values. Default is FALSE.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return The most frequent value in the vector, or NA if input is empty after NA removal.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' stat_mode(c(1, 2, 2, 3))</span>
stat_mode &lt;- <span class="hljs-keyword">function</span>(x, na.rm = <span class="hljs-literal">FALSE</span>) {
  x &lt;- na.omit(x)
  <span class="hljs-keyword">if</span> (length(x) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span>(<span class="hljs-literal">NA</span>)
  }
  model_value &lt;- names(sort(table(value = x), decreasing = <span class="hljs-literal">TRUE</span>)[<span class="hljs-number">1</span>])
}

<span class="hljs-comment">#' Clean Columns with Missing Values</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Identifies columns with missing values. If more than 20% of the values in a column are missing,</span>
<span class="hljs-comment">#' the column is dropped. Otherwise, missing values are replaced with the column's minimum value.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame containing numeric columns with missing values.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A cleaned data frame with imputed or removed columns as appropriate.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' clean_missing_numeric_columns(pima_df)</span>
clean_missing_numeric_columns &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  incomplete_numeric_columns &lt;- c()
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
    <span class="hljs-keyword">if</span> (any(is.na(data_frame[[col]]))) {
      incomplete_numeric_columns &lt;- c(incomplete_numeric_columns, col)
    }
  }
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> incomplete_numeric_columns) {
    total_count &lt;- length(data_frame[[col]])
    na_count &lt;- sum(is.na(data_frame[[col]]))
    <span class="hljs-keyword">if</span> ((na_count / total_count) &gt; <span class="hljs-number">0.20</span>) {
      data_frame[[col]] &lt;- <span class="hljs-literal">NULL</span>
    } <span class="hljs-keyword">else</span> {
      min_value &lt;- min(data_frame[[col]])
      data_frame[[col]][is.na(data_frame[[col]])] &lt;- min_value
    }
  }
  <span class="hljs-keyword">return</span>(data_frame)
}


<span class="hljs-comment">#' Remove Rows with Zero Values in Key Columns</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Iterates through the data frame and flags rows where any numeric column (except for 'Outcome' or 'Pregnancies')</span>
<span class="hljs-comment">#' contains a zero. The rows are retained in the current implementation but flagged for exclusion logic.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame to be processed.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame with rows containing zero values (in numeric columns, excluding "Outcome" and "Pregnancies") removed.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' clean_row_with_zero(pima_df)</span>
clean_row_with_zero &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  <span class="hljs-keyword">for</span> (row <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nrow(data_frame)) {
    <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
      <span class="hljs-keyword">if</span> (!(col %<span class="hljs-keyword">in</span>% c(<span class="hljs-string">"Outcome"</span>, <span class="hljs-string">"Pregnancies"</span>)) &amp;&amp;
        is.numeric(data_frame[[col]])) {
        <span class="hljs-keyword">if</span> (!is.na(data_frame[row, col]) &amp;&amp; data_frame[row, col] == <span class="hljs-number">0</span>) {
          value &lt;- data_frame[row, col]
          <span class="hljs-keyword">if</span> (!is.na(value) &amp;&amp; value == <span class="hljs-number">0</span>) {
            data_frame[row] &lt;- <span class="hljs-literal">NA</span>  <span class="hljs-comment"># Set the entire row to NA if a zero is found</span>
          }
        }
      }
    }
  }
  data_frame &lt;- na.omit(data_frame)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Execute Full Preprocessing and Generate Summary Table</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Loads, cleans, and preprocesses the PIMA dataset. Cleans missing values, removes problematic rows,</span>
<span class="hljs-comment">#' and generates a pivot table grouped by `Outcome` showing mean and median for each numeric variable.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return No return value. Prints summary table to console.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' runner()</span>
runner &lt;- <span class="hljs-keyword">function</span>() {
  pima &lt;- load_dataset(PIMA_PATH)
  pima &lt;- clean_missing_numeric_columns(pima)
  pima &lt;- clean_row_with_zero(pima)
  pima_outcome_pivot &lt;- pima %&gt;%
    group_by(Outcome) %&gt;%
    summarise(across(
      where(is.numeric) &amp; !matches(<span class="hljs-string">"Outcome"</span>),
      list(
        mean = ~ mean(.x, na.rm = <span class="hljs-literal">TRUE</span>),
        median = ~ median(.x, na.rm = <span class="hljs-literal">TRUE</span>)
      ),
      .names = <span class="hljs-string">"{.col}_{.fn}"</span>
    ))
  cat(<span class="hljs-string">"\nPIMA Outcome Pivot Table:"</span>, <span class="hljs-string">"\n"</span>)
  print.data.frame(pima_outcome_pivot)
}
runner()
</div></code></pre>
<table>
<thead>
<tr>
<th>Outcome</th>
<th>Pregnancies_mean</th>
<th>Pregnancies_median</th>
<th>BloodPressure_mean</th>
<th>BloodPressure_median</th>
<th>SkinThickness_mean</th>
<th>SkinThickness_median</th>
<th>BMI_mean</th>
<th>BMI_median</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>3.298</td>
<td>2</td>
<td>68.184</td>
<td>70</td>
<td>19.664</td>
<td>21</td>
<td>30.85967</td>
<td>30.1</td>
</tr>
<tr>
<td>1</td>
<td>4.865672</td>
<td>4</td>
<td>70.82463</td>
<td>74</td>
<td>22.16418</td>
<td>27</td>
<td>35.40677</td>
<td>34.3</td>
</tr>
</tbody>
</table>
<p>6- Generate a heatmap plot that shows the correlation values between all variables in the dataset.</p>
<pre class="hljs"><code><div>
<span class="hljs-keyword">library</span>(dplyr)
<span class="hljs-keyword">library</span>(tidyr)
<span class="hljs-keyword">library</span>(readr)
<span class="hljs-keyword">library</span>(styler)
<span class="hljs-keyword">library</span>(reshape2)
<span class="hljs-keyword">library</span>(ggplot2)

PIMA_PATH &lt;- <span class="hljs-string">"Diabetes-data.csv"</span>
<span class="hljs-comment">#' Load the PIMA Diabetes Dataset</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Loads the PIMA dataset from a CSV file using `readr::read_csv`.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param file_path String. Path to the dataset file.</span>
<span class="hljs-comment">#' @param col_names Logical. Indicates whether the first row contains column names. Default is TRUE.</span>
<span class="hljs-comment">#' @param display_type Logical. If TRUE, displays column type messages. Default is FALSE.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame containing the loaded data.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
load_dataset &lt;- <span class="hljs-keyword">function</span>(file_path,
                         col_names = <span class="hljs-literal">TRUE</span>,
                         display_type = <span class="hljs-literal">FALSE</span>) {
  data_frame &lt;- read_csv(file_path, col_names = col_names, show_col_types = display_type)
  <span class="hljs-keyword">return</span>(data_frame)
}


<span class="hljs-comment">#' Calculate the Mode of a Vector</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Computes the most frequently occurring value in a vector.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param x A numeric or character vector.</span>
<span class="hljs-comment">#' @param na.rm Logical. If TRUE, missing values are removed. Default is FALSE.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return The mode (most frequent value), or NA if input is empty after NA removal.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' stat_mode(c(1, 1, 2, 3))  # returns 1</span>
stat_mode &lt;- <span class="hljs-keyword">function</span>(x, na.rm = <span class="hljs-literal">FALSE</span>) {
  x &lt;- na.omit(x)
  <span class="hljs-keyword">if</span> (length(x) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span>(<span class="hljs-literal">NA</span>)
  }
  model_value &lt;- names(sort(table(value = x), decreasing = <span class="hljs-literal">TRUE</span>)[<span class="hljs-number">1</span>])
}

<span class="hljs-comment">#' Clean Columns with Missing Data</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Drops columns with more than 20% missing values. Fills remaining missing values</span>
<span class="hljs-comment">#' with the minimum value of that column.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame with possible missing values.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A cleaned data frame with NA values handled or dropped.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' clean_missing_numeric_columns(pima_df)</span>
clean_missing_numeric_columns &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  incomplete_numeric_columns &lt;- c()
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
    <span class="hljs-keyword">if</span> (any(is.na(data_frame[[col]]))) {
      incomplete_numeric_columns &lt;- c(incomplete_numeric_columns, col)
    }
  }
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> incomplete_numeric_columns) {
    total_count &lt;- length(data_frame[[col]])
    na_count &lt;- sum(is.na(data_frame[[col]]))
    <span class="hljs-keyword">if</span> ((na_count / total_count) &gt; <span class="hljs-number">0.20</span>) {
      data_frame[[col]] &lt;- <span class="hljs-literal">NULL</span>
    } <span class="hljs-keyword">else</span> {
      min_value &lt;- min(data_frame[[col]])
      data_frame[[col]][is.na(data_frame[[col]])] &lt;- min_value
    }
  }
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Remove Rows with Zeroes in Numeric Variables</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Scans all numeric variables (excluding 'Outcome' and 'Pregnancies') and flags rows</span>
<span class="hljs-comment">#' containing 0 values for review. Currently retains all rows.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame to be checked.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame with rows containing zero values (in numeric columns, excluding "Outcome" and "Pregnancies") removed.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' clean_row_with_zero(pima_df)</span>
clean_row_with_zero &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  <span class="hljs-keyword">for</span> (row <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nrow(data_frame)) {
    <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
      <span class="hljs-keyword">if</span> (!(col %<span class="hljs-keyword">in</span>% c(<span class="hljs-string">"Outcome"</span>, <span class="hljs-string">"Pregnancies"</span>)) &amp;&amp;
        is.numeric(data_frame[[col]])) {
        <span class="hljs-keyword">if</span> (!is.na(data_frame[row, col]) &amp;&amp; data_frame[row, col] == <span class="hljs-number">0</span>) {
          value &lt;- data_frame[row, col]
          <span class="hljs-keyword">if</span> (!is.na(value) &amp;&amp; value == <span class="hljs-number">0</span>) {
            data_frame[row] &lt;- <span class="hljs-literal">NA</span>  <span class="hljs-comment"># Set the entire row to NA if a zero is found</span>
          }
        }
      }
    }
  }
  data_frame &lt;- na.omit(data_frame)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Main Processing Pipeline for PIMA Dataset</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Executes full data preparation: loading, cleaning missing values, filtering rows,</span>
<span class="hljs-comment">#' and generating a correlation heatmap.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Steps include:</span>
<span class="hljs-comment">#' - Reading the dataset</span>
<span class="hljs-comment">#' - Removing columns with &gt;20% missing values</span>
<span class="hljs-comment">#' - Imputing remaining NAs with column minimums</span>
<span class="hljs-comment">#' - Dropping rows with zero values in numeric columns</span>
<span class="hljs-comment">#' - Computing pairwise correlations (excluding NA-only columns)</span>
<span class="hljs-comment">#' - Displaying a heatmap of variable correlations using ggplot2</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return No return value. Displays a correlation heatmap using ggplot2.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' runner()</span>
runner &lt;- <span class="hljs-keyword">function</span>() {
  pima &lt;- load_dataset(PIMA_PATH)
  pima &lt;- clean_missing_numeric_columns(pima)
  pima &lt;- clean_row_with_zero(pima)
  pima &lt;- pima %&gt;%
    select(where(is.numeric)) %&gt;%
    select(where(~ !all(is.na(.x))))
  corelation_matrix &lt;- cor(pima, use = <span class="hljs-string">"complete.obs"</span>)
  corelation_dataframe &lt;- as.data.frame(as.table(corelation_matrix)) %&gt;%
    filter(Var1 != Var2) %&gt;%
    arrange(desc(Freq))
  colnames(corelation_dataframe) &lt;- c(<span class="hljs-string">"Var1"</span>, <span class="hljs-string">"Var2"</span>, <span class="hljs-string">"Correlation"</span>)
  ggplot(corelation_dataframe, aes(x = Var1, y = Var2, fill = Correlation)) +
    geom_tile(color = <span class="hljs-string">"white"</span>) +
    scale_fill_gradient2(
      low = <span class="hljs-string">"blue"</span>,
      mid = <span class="hljs-string">"yellow"</span>,
      high = <span class="hljs-string">"red"</span>
    ) +
    labs(title = <span class="hljs-string">"Correlation Heatmap of PIMA Variables"</span>, x = <span class="hljs-literal">NULL</span>, y = <span class="hljs-literal">NULL</span>) +
    theme(axis.text.x = element_text(angle = <span class="hljs-number">45</span>, hjust = <span class="hljs-number">1</span>))
}
runner()

</div></code></pre>
<p><img src="heatmap.png" alt="Heatmap of Correlation Matrix"></p>
<p>7- Generate a scatter plot showing Glucose in the x-axis and BMI in the y-axis. Colourise the markers by Outcome (e.g. markers representing diabetic individuals should be red and markers representing non-diabetic individuals should be blue).</p>
<pre class="hljs"><code><div><span class="hljs-keyword">library</span>(dplyr)
<span class="hljs-keyword">library</span>(tidyr)
<span class="hljs-keyword">library</span>(readr)
<span class="hljs-keyword">library</span>(styler)
<span class="hljs-keyword">library</span>(reshape2)
<span class="hljs-keyword">library</span>(ggplot2)


PIMA_PATH &lt;- <span class="hljs-string">"Diabetes-data.csv"</span>
<span class="hljs-comment">#' Load the PIMA Diabetes Dataset</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Reads a CSV file into a data frame using readr. Optionally displays column type information.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param file_path String. Path to the CSV file.</span>
<span class="hljs-comment">#' @param col_names Logical. Whether the file contains header names. Default_</span>
load_dataset &lt;- <span class="hljs-keyword">function</span>(file_path,
                         col_names = <span class="hljs-literal">TRUE</span>,
                         display_type = <span class="hljs-literal">FALSE</span>) {
  data_frame &lt;- read_csv(file_path, col_names = col_names, show_col_types = display_type)
  <span class="hljs-keyword">return</span>(data_frame)
}


<span class="hljs-comment">#' Calculate the Mode of a Vector</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Returns the most frequent (modal) value in the vector, ignoring NA values.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param x A numeric or character vector.</span>
<span class="hljs-comment">#' @param na.rm Logical. If TRUE, missing values are removed before calculation.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return The mode (most common value) of the vector. Returns NA if no values are present.</span>
stat_mode &lt;- <span class="hljs-keyword">function</span>(x, na.rm = <span class="hljs-literal">FALSE</span>) {
  x &lt;- na.omit(x)
  <span class="hljs-keyword">if</span> (length(x) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span>(<span class="hljs-literal">NA</span>)
  }
  model_value &lt;- names(sort(table(value = x), decreasing = <span class="hljs-literal">TRUE</span>)[<span class="hljs-number">1</span>])
}

<span class="hljs-comment">#' Handle Missing Values in Numeric Columns</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Checks for missing values in each column. If more than 20% are missing, the column is dropped.</span>
<span class="hljs-comment">#' Otherwise, missing values are replaced with the column's minimum value.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame with possible NA values.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A cleaned data frame with no columns having &gt;20% missing values, and missing values imputed.</span>
clean_missing_numeric_columns &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  incomplete_numeric_columns &lt;- c()
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
    <span class="hljs-keyword">if</span> (any(is.na(data_frame[[col]]))) {
      incomplete_numeric_columns &lt;- c(incomplete_numeric_columns, col)
    }
  }
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> incomplete_numeric_columns) {
    total_count &lt;- length(data_frame[[col]])
    na_count &lt;- sum(is.na(data_frame[[col]]))
    <span class="hljs-keyword">if</span> ((na_count / total_count) &gt; <span class="hljs-number">0.20</span>) {
      data_frame[[col]] &lt;- <span class="hljs-literal">NULL</span>
    } <span class="hljs-keyword">else</span> {
      min_value &lt;- min(data_frame[[col]])
      data_frame[[col]][is.na(data_frame[[col]])] &lt;- min_value
    }
  }
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Placeholder Loop for Zero-Value Checking</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Iterates through numeric columns (except 'Outcome' and 'Pregnancies') to examine rows with 0 values.</span>
<span class="hljs-comment">#' Does not currently filter out rows — this may be intended for validation or inspection logic.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame The input data frame to be checked.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame with rows containing zero values (in numeric columns, excluding "Outcome" and "Pregnancies") removed.</span>
clean_row_with_zero &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  <span class="hljs-keyword">for</span> (row <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nrow(data_frame)) {
    <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
      <span class="hljs-keyword">if</span> (!(col %<span class="hljs-keyword">in</span>% c(<span class="hljs-string">"Outcome"</span>, <span class="hljs-string">"Pregnancies"</span>)) &amp;&amp;
        is.numeric(data_frame[[col]])) {
        <span class="hljs-keyword">if</span> (!is.na(data_frame[row, col]) &amp;&amp; data_frame[row, col] == <span class="hljs-number">0</span>) {
          value &lt;- data_frame[row, col]
          <span class="hljs-keyword">if</span> (!is.na(value) &amp;&amp; value == <span class="hljs-number">0</span>) {
            data_frame[row] &lt;- <span class="hljs-literal">NA</span>  <span class="hljs-comment"># Set the entire row to NA if a zero is found</span>
          }
        }
      }
    }
  }
  data_frame &lt;- na.omit(data_frame)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Placeholder Loop for Zero-Value Checking</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Iterates through numeric columns (except 'Outcome' and 'Pregnancies') to examine rows with 0 values.</span>
<span class="hljs-comment">#' Does not currently filter out rows — this may be intended for validation or inspection logic.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame The input data frame to be checked.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return The unchanged input data frame.</span>
runner &lt;- <span class="hljs-keyword">function</span>() {
  pima &lt;- load_dataset(PIMA_PATH)
  pima &lt;- clean_missing_numeric_columns(pima)
  pima &lt;- clean_row_with_zero(pima)
  pima[pima == <span class="hljs-string">"?"</span>] &lt;- <span class="hljs-literal">NA</span>
  pima[pima == <span class="hljs-string">""</span>] &lt;- <span class="hljs-literal">NA</span>
  pima$Glucose &lt;- as.numeric(pima$Glucose)
  pima &lt;- pima %&gt;%
    filter(!is.na(Glucose), !is.na(BMI))
  pima &lt;- pima %&gt;% mutate(GlucoseGroup = cut(Glucose, breaks = seq(<span class="hljs-number">0</span>, <span class="hljs-number">200</span>, by = <span class="hljs-number">10</span>)))
  ggplot(pima, aes(
    x = Glucose,
    y = BMI,
    color = factor(Outcome)
  )) +
    geom_jitter(
      width = <span class="hljs-number">1.5</span>,
      height = <span class="hljs-number">0</span>,
      alpha = <span class="hljs-number">0.7</span>,
      size = <span class="hljs-number">2</span>
    ) +
    labs(
      title = <span class="hljs-string">"Scatter Plot of Glucose vs Insulin"</span>,
      x = <span class="hljs-string">"Glucose Level"</span>,
      y = <span class="hljs-string">"Insulin Level"</span>,
      color = <span class="hljs-string">"Diabetes Outcome"</span>
    ) +
    scale_color_manual(
      values = c(<span class="hljs-string">"0"</span> = <span class="hljs-string">"blue"</span>, <span class="hljs-string">"1"</span> = <span class="hljs-string">"red"</span>),
      name = <span class="hljs-string">"Diabetes  Outcome"</span>,
      labels = c(<span class="hljs-string">"Non-Diabetic"</span>, <span class="hljs-string">"Diabetic"</span>)
    ) +
    theme_minimal() +
    theme(legend.position = <span class="hljs-string">"bottom"</span>)
}
runner()
</div></code></pre>
<p><img src="scatter_plot.png" alt="Scatter Plot"></p>
<p>8- Create a new column in the dataset to categorise BMI into groups. For example, you can create three categories: &quot;Underweight&quot; for BMI &lt; 23, &quot;Normal Weight&quot; for BMI between 23 to 29 inclusive, and &quot;Overweight&quot; for BMI &gt; 29. You can choose your own range of values if you wish but make sure you avoid weight value overlapping and ambiguity.</p>
<table>
<thead>
<tr>
<th>Pregnancies</th>
<th>Glucose</th>
<th>BloodPressure</th>
<th>SkinThickness</th>
<th>BMI</th>
<th>DiabetesPedigreeFunction</th>
<th>Age</th>
<th>Outcome</th>
<th>Category</th>
</tr>
</thead>
<tbody>
<tr>
<td>6</td>
<td>148</td>
<td>72</td>
<td>35</td>
<td>33.6</td>
<td>0.627</td>
<td>50</td>
<td>1</td>
<td>Overweight</td>
</tr>
<tr>
<td>1</td>
<td>85</td>
<td>66</td>
<td>29</td>
<td>26.6</td>
<td>0.351</td>
<td>31</td>
<td>0</td>
<td>Normal Weight</td>
</tr>
<tr>
<td>8</td>
<td>183</td>
<td>64</td>
<td>0</td>
<td>23.3</td>
<td>0.672</td>
<td>32</td>
<td>1</td>
<td>Normal Weight</td>
</tr>
<tr>
<td>1</td>
<td>89</td>
<td>66</td>
<td>23</td>
<td>28.1</td>
<td>0.167</td>
<td>21</td>
<td>0</td>
<td>Normal Weight</td>
</tr>
<tr>
<td>0</td>
<td>137</td>
<td>40</td>
<td>35</td>
<td>43.1</td>
<td>2.288</td>
<td>33</td>
<td>1</td>
<td>Overweight</td>
</tr>
<tr>
<td>5</td>
<td>116</td>
<td>74</td>
<td>0</td>
<td>25.6</td>
<td>0.201</td>
<td>30</td>
<td>0</td>
<td>Normal Weight</td>
</tr>
</tbody>
</table>
<p>9- Group the data by BMI category and calculate the percentage of individuals with diabetes within each category. Your code should display the BMI categories and the corresponding percentage of individuals with diabetes.</p>
<table>
<thead>
<tr>
<th>Category</th>
<th>Count</th>
<th>Diabetes_Outcome</th>
<th>Percentage</th>
</tr>
</thead>
<tbody>
<tr>
<td>Normal Weight</td>
<td>204</td>
<td>38</td>
<td>18.6</td>
</tr>
<tr>
<td>Overweight</td>
<td>503</td>
<td>227</td>
<td>45.1</td>
</tr>
<tr>
<td>Underweight</td>
<td>50</td>
<td>1</td>
<td>2.0</td>
</tr>
</tbody>
</table>
<p>Code for Both 8 and 9</p>
<pre class="hljs"><code><div><span class="hljs-keyword">library</span>(dplyr)
<span class="hljs-keyword">library</span>(tidyr)
<span class="hljs-keyword">library</span>(readr)
<span class="hljs-keyword">library</span>(styler)
<span class="hljs-keyword">library</span>(reshape2)
<span class="hljs-keyword">library</span>(ggplot2)


PIMA_PATH &lt;- <span class="hljs-string">"Diabetes-data.csv"</span>

<span class="hljs-comment">#' Load the PIMA Diabetes Dataset</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Loads the PIMA dataset from a CSV file using `readr::read_csv`.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param file_path String. Path to the dataset file.</span>
<span class="hljs-comment">#' @param col_names Logical. Indicates if the first row contains column names. Default is TRUE.</span>
<span class="hljs-comment">#' @param display_type Logical. If TRUE, displays column type messages. Default is FALSE.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame containing the loaded data.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' load_dataset("Diabetes-data.csv")</span>
load_dataset &lt;- <span class="hljs-keyword">function</span>(file_path,
                         col_names = <span class="hljs-literal">TRUE</span>,
                         display_type = <span class="hljs-literal">FALSE</span>) {
  data_frame &lt;- read_csv(file_path, col_names = col_names, show_col_types = display_type)
  <span class="hljs-keyword">return</span>(data_frame)
}


<span class="hljs-comment">#' Calculate the Mode of a Vector</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Returns the most frequent value in a vector. If the input is empty after NA removal, returns NA.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param x A numeric or character vector.</span>
<span class="hljs-comment">#' @param na.rm Logical. Whether to remove missing values. Default is FALSE.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A scalar value representing the mode.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' stat_mode(c(1, 2, 2, 3))  # Returns 2</span>
stat_mode &lt;- <span class="hljs-keyword">function</span>(x, na.rm = <span class="hljs-literal">FALSE</span>) {
  x &lt;- na.omit(x)
  <span class="hljs-keyword">if</span> (length(x) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span>(<span class="hljs-literal">NA</span>)
  }
  model_value &lt;- names(sort(table(value = x), decreasing = <span class="hljs-literal">TRUE</span>)[<span class="hljs-number">1</span>])
}

<span class="hljs-comment">#' Clean Missing Data from Numeric Columns</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Identifies columns with missing values. If more than 20% of values are missing, the column is dropped.</span>
<span class="hljs-comment">#' Otherwise, missing values are replaced with the minimum of that column.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame with possible missing values.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A cleaned data frame with imputed or removed columns.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' clean_missing_numeric_columns(pima_df)</span>
clean_missing_numeric_columns &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  incomplete_numeric_columns &lt;- c()
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
    <span class="hljs-keyword">if</span> (any(is.na(data_frame[[col]]))) {
      incomplete_numeric_columns &lt;- c(incomplete_numeric_columns, col)
    }
  }
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> incomplete_numeric_columns) {
    total_count &lt;- length(data_frame[[col]])
    na_count &lt;- sum(is.na(data_frame[[col]]))
    <span class="hljs-keyword">if</span> ((na_count / total_count) &gt; <span class="hljs-number">0.20</span>) {
      data_frame[[col]] &lt;- <span class="hljs-literal">NULL</span>
    } <span class="hljs-keyword">else</span> {
      min_value &lt;- min(data_frame[[col]])
      data_frame[[col]][is.na(data_frame[[col]])] &lt;- min_value
    }
  }
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Categorize Individuals by BMI</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Assigns BMI categories ("Underweight", "Normal Weight", "Overweight") to each row in the dataset</span>
<span class="hljs-comment">#' based on the BMI value.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame containing a BMI column.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame with an additional column 'Category' indicating weight category.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' append_table_with_category(pima_df)</span>
append_table_with_category &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  <span class="hljs-keyword">for</span> (row <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nrow(data_frame)) {
    weight_value &lt;- data_frame[row, <span class="hljs-string">"BMI"</span>]
    category_value &lt;- <span class="hljs-keyword">if</span> (is.na(weight_value)) {
      <span class="hljs-literal">NA_character_</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (weight_value &lt; <span class="hljs-number">23</span>) {
      <span class="hljs-string">"Underweight"</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (weight_value &lt;= <span class="hljs-number">29</span>) {
      <span class="hljs-string">"Normal Weight"</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-string">"Overweight"</span>
    }

    data_frame[row, <span class="hljs-string">"Category"</span>] &lt;- category_value
  }
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Identify and Retain Rows Without Zero in Numeric Columns</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Iterates through all numeric columns (except 'Outcome' and 'Pregnancies') and retains all rows.</span>
<span class="hljs-comment">#' Intended for placeholder or validation logic.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame to process.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame with rows containing zero values (in numeric columns, excluding "Outcome" and "Pregnancies") removed.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' clean_row_with_zero(pima_df)</span>
clean_row_with_zero &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  <span class="hljs-keyword">for</span> (row <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nrow(data_frame)) {
    <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
      <span class="hljs-keyword">if</span> (!(col %<span class="hljs-keyword">in</span>% c(<span class="hljs-string">"Outcome"</span>, <span class="hljs-string">"Pregnancies"</span>)) &amp;&amp;
        is.numeric(data_frame[[col]])) {
        <span class="hljs-keyword">if</span> (!is.na(data_frame[row, col]) &amp;&amp; data_frame[row, col] == <span class="hljs-number">0</span>) {
          value &lt;- data_frame[row, col]
          <span class="hljs-keyword">if</span> (!is.na(value) &amp;&amp; value == <span class="hljs-number">0</span>) {
            data_frame[row] &lt;- <span class="hljs-literal">NA</span>  <span class="hljs-comment"># Set the entire row to NA if a zero is found</span>
          }
        }
      }
    }
  }
  data_frame &lt;- na.omit(data_frame)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Filter and Convert BMI Column</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Replaces invalid BMI entries ('?' or blank) with NA, converts to numeric, and filters out NA or zero values.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame containing a BMI column.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A filtered data frame with valid numeric BMI values only.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' filter_weight_columns(pima_df)</span>
filter_weight_columns &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  data_frame$BMI[data_frame$BMI == <span class="hljs-string">"?"</span>] &lt;- <span class="hljs-literal">NA</span>
  data_frame$BMI[data_frame$BMI == <span class="hljs-string">""</span>] &lt;- <span class="hljs-literal">NA</span>
  data_frame$BMI &lt;- as.numeric(data_frame$BMI)
  data_frame &lt;- data_frame %&gt;%
    filter(!is.na(BMI), BMI != <span class="hljs-number">0</span>)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Main Runner Function for Processing and Aggregation</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Loads and preprocesses the PIMA dataset, assigns BMI categories, and computes the percentage of</span>
<span class="hljs-comment">#' diabetic individuals within each category. Prints a pivot table summarizing the result.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return No return value. Prints the output pivot table to the console.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @examples</span>
<span class="hljs-comment">#' runner()</span>
runner &lt;- <span class="hljs-keyword">function</span>() {
  pima &lt;- load_dataset(PIMA_PATH)
  pima &lt;- clean_row_with_zero(pima)
  pima &lt;- clean_missing_numeric_columns(pima)
  pima &lt;- filter_weight_columns(pima)
  pima &lt;- append_table_with_category(pima)
  pima_outcome_pivot &lt;- pima %&gt;%
    group_by(Category) %&gt;%
    summarise(
      Count = n(),
      Diabetes_Outcome = sum(Outcome == <span class="hljs-number">1</span>, na.rm = <span class="hljs-literal">TRUE</span>),
      Percentage = (Diabetes_Outcome / Count) * <span class="hljs-number">100</span>
    )
  print(pima_outcome_pivot)
}

runner()

</div></code></pre>
<p>10- Generate a scatter matrix plot showing all variables vs each other with histograms on the diagonal. Feel free to use existing open-source R packages.</p>
<pre class="hljs"><code><div><span class="hljs-keyword">library</span>(dplyr)
<span class="hljs-keyword">library</span>(tidyr)
<span class="hljs-keyword">library</span>(readr)
<span class="hljs-keyword">library</span>(styler)
<span class="hljs-keyword">library</span>(reshape2)
<span class="hljs-keyword">library</span>(ggplot2)
<span class="hljs-keyword">library</span>(GGally)

PIMA_PATH &lt;- <span class="hljs-string">"Diabetes-data.csv"</span>

<span class="hljs-comment">#' Load the PIMA Diabetes Dataset</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Reads a CSV file into a data frame using `read_csv`. Optionally shows column types.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param file_path Path to the dataset CSV file.</span>
<span class="hljs-comment">#' @param col_names Logical; if TRUE, treats first row as column headers.</span>
<span class="hljs-comment">#' @param display_type Logical; if TRUE, displays column type messages.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame containing the loaded data.</span>
load_dataset &lt;- <span class="hljs-keyword">function</span>(file_path,
                         col_names = <span class="hljs-literal">TRUE</span>,
                         display_type = <span class="hljs-literal">FALSE</span>) {
  data_frame &lt;- read_csv(file_path, col_names = col_names, show_col_types = display_type)
  <span class="hljs-keyword">return</span>(data_frame)
}


<span class="hljs-comment">#' Calculate the Statistical Mode of a Vector</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Returns the most frequently occurring value (mode) in the input vector.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param x A numeric or character vector.</span>
<span class="hljs-comment">#' @param na.rm Logical; if TRUE, removes NA values before computation.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return The most common value in the vector, or NA if the input is empty.</span>
stat_mode &lt;- <span class="hljs-keyword">function</span>(x, na.rm = <span class="hljs-literal">FALSE</span>) {
  x &lt;- na.omit(x)
  <span class="hljs-keyword">if</span> (length(x) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span>(<span class="hljs-literal">NA</span>)
  }
  model_value &lt;- names(sort(table(value = x), decreasing = <span class="hljs-literal">TRUE</span>)[<span class="hljs-number">1</span>])
}

<span class="hljs-comment">#' Clean Columns with Missing Numeric Data</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Checks each column for NA values. Drops the column if more than 20% are missing; otherwise, replaces NA with the column's minimum value.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame to process.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A cleaned data frame with fewer or no missing numeric values.</span>
clean_missing_numeric_columns &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  incomplete_numeric_columns &lt;- c()
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
    <span class="hljs-keyword">if</span> (any(is.na(data_frame[[col]]))) {
      incomplete_numeric_columns &lt;- c(incomplete_numeric_columns, col)
    }
  }
  <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> incomplete_numeric_columns) {
    total_count &lt;- length(data_frame[[col]])
    na_count &lt;- sum(is.na(data_frame[[col]]))
    <span class="hljs-keyword">if</span> ((na_count / total_count) &gt; <span class="hljs-number">0.20</span>) {
      data_frame[[col]] &lt;- <span class="hljs-literal">NULL</span>
    } <span class="hljs-keyword">else</span> {
      min_value &lt;- min(data_frame[[col]])
      data_frame[[col]][is.na(data_frame[[col]])] &lt;- min_value
    }
  }
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Inspect for Zeroes in Numeric Columns</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Loops through each row and checks numeric columns (except Outcome and Pregnancies) for zeroes. Currently retains all data — placeholder logic.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame to validate.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A data frame with rows containing zero values (in numeric columns, excluding "Outcome" and "Pregnancies") removed.</span>
clean_row_with_zero &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  <span class="hljs-keyword">for</span> (row <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>:nrow(data_frame)) {
    <span class="hljs-keyword">for</span> (col <span class="hljs-keyword">in</span> names(data_frame)) {
      <span class="hljs-keyword">if</span> (!(col %<span class="hljs-keyword">in</span>% c(<span class="hljs-string">"Outcome"</span>, <span class="hljs-string">"Pregnancies"</span>)) &amp;&amp;
        is.numeric(data_frame[[col]])) {
        <span class="hljs-keyword">if</span> (!is.na(data_frame[row, col]) &amp;&amp; data_frame[row, col] == <span class="hljs-number">0</span>) {
          value &lt;- data_frame[row, col]
          <span class="hljs-keyword">if</span> (!is.na(value) &amp;&amp; value == <span class="hljs-number">0</span>) {
            data_frame[row] &lt;- <span class="hljs-literal">NA</span>  <span class="hljs-comment"># Set the entire row to NA if a zero is found</span>
          }
        }
      }
    }
  }
  data_frame &lt;- na.omit(data_frame)
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Clean and Convert Glucose, BMI, and Related Columns</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Replaces invalid entries (`?` and blanks) with NA, coerces specified columns to numeric, and bins Glucose values into deciles.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @param data_frame A data frame containing Glucose and BMI fields.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A cleaned and transformed data frame with a GlucoseGroup column.</span>
clean_up_glucose_bmi &lt;- <span class="hljs-keyword">function</span>(data_frame) {
  data_frame[data_frame == <span class="hljs-string">"?"</span>] &lt;- <span class="hljs-literal">NA</span>
  data_frame[data_frame == <span class="hljs-string">""</span>] &lt;- <span class="hljs-literal">NA</span>
  data_frame$Glucose &lt;- as.numeric(data_frame$Glucose)
  data_frame$DiabetesPedigreeFunction &lt;- as.numeric(as.character(data_frame$DiabetesPedigreeFunction))
  data_frame$Age &lt;- as.numeric(as.character(data_frame$Age))

  data_frame &lt;- data_frame %&gt;%
    filter(!is.na(Glucose), !is.na(BMI))
  data_frame &lt;- data_frame %&gt;% mutate(GlucoseGroup = cut(Glucose, breaks = seq(<span class="hljs-number">0</span>, <span class="hljs-number">200</span>, by = <span class="hljs-number">10</span>)))
  <span class="hljs-keyword">return</span>(data_frame)
}

<span class="hljs-comment">#' Run the Full Data Cleaning and Scatter Matrix Plot</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' Loads and preprocesses the PIMA dataset, including cleaning, NA handling, and binning.</span>
<span class="hljs-comment">#' Produces a scatter matrix plot (pairplot) to visualize variable relationships by diabetes status.</span>
<span class="hljs-comment">#'</span>
<span class="hljs-comment">#' @return A `ggpairs` object visualizing the dataset. Also plots it to the graphics device.</span>
runner &lt;- <span class="hljs-keyword">function</span>() {
  pima &lt;- load_dataset(PIMA_PATH)
  pima &lt;- clean_missing_numeric_columns(pima)
  pima &lt;- clean_row_with_zero(pima)
  pima &lt;- clean_up_glucose_bmi(pima)

  ggpairs(
    data = pima,
    columns = c(
      <span class="hljs-string">"Pregnancies"</span>,
      <span class="hljs-string">"Glucose"</span>,
      <span class="hljs-string">"BloodPressure"</span>,
      <span class="hljs-string">"SkinThickness"</span>,
      <span class="hljs-string">"BMI"</span>,
      <span class="hljs-string">"DiabetesPedigreeFunction"</span>,
      <span class="hljs-string">"Age"</span>
    ),
    aes(color = factor(Outcome), alpha = <span class="hljs-number">0.5</span>),
    lower = list(continuous = wrap(<span class="hljs-string">"points"</span>, alpha = <span class="hljs-number">1.5</span>)),
    diag = list(continuous = wrap(<span class="hljs-string">"barDiag"</span>, bins = <span class="hljs-number">15</span>)),
    upper = list(continuous = wrap(<span class="hljs-string">"cor"</span>, size = <span class="hljs-number">3</span>))
  ) +
    theme_minimal() +
    labs(title = <span class="hljs-string">"Scatter Matrix of PIMA Indian Diabetes Dataset"</span>, subtitle = <span class="hljs-string">"Showing relationships between Pregnancies,Glucose,BloodPressure,SkinThickness,BMI,DiabetesPedigreeFunction,Age"</span>)
}
runner()

![Scatter Matrix](scatter_matrix.png)


---

<span class="hljs-comment">### Tip(s):</span>
write comments to explain your code and avoid hard-coding values (i.e. make sure your code is as generic as possible).

---

<span class="hljs-comment">## Submission Guidelines:</span>

- Submission deadline is July 20th, <span class="hljs-number">2025.</span>  
- Document your R code <span class="hljs-keyword">in</span> a well-structured report. We recommend you answer the questions <span class="hljs-keyword">in</span> order.  
- Make sure you submit either a Word Document or a PDF file.  
- We will run your code, so make sure the code is plain-text and not a screenshot (you can include screenshots of the results).  
- Make sure you include your Declaration of Authorship form.  
- Submit your report by emailing it to (Please send your report as an attachment): weeklyclasses@conted.ox.ac.uk  

---

<span class="hljs-comment">### Note:</span>
Feel free to explore additional resources, documentation, and online tutorials to enhance your understanding and complete the tasks effectively.

**All the best with your assignment!**
</div></code></pre>

</body>
</html>
